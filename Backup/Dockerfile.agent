FROM public.ecr.aws/docker/library/python:3.12-slim

# ---------------------------------------------------------
# Environment
# ---------------------------------------------------------
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1
ENV PIP_NO_CACHE_DIR=1

WORKDIR /app

# ---------------------------------------------------------
# Install runtime dependencies only
# ---------------------------------------------------------
COPY pyproject.toml ./

RUN pip install --upgrade pip \
    && pip install .

# ---------------------------------------------------------
# Copy agent source code
# ---------------------------------------------------------
COPY src/ ./src/

# ---------------------------------------------------------
# AgentCore entrypoint
# ---------------------------------------------------------
CMD ["python", "-m", "src.main"]
